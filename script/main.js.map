{"version":3,"sources":["main.js"],"names":["$","document","ready","activeRow","activeMenu","timer","sub","mouseInSub","on","e","mouseTrack","moveHandler","push","x","pageX","y","pageY","length","shift","addClass","removeClass","off","target","data","clearTimeout","currMousePos","leftCorner","delay","needDelay","setTimeout","prevActiveRow","prevActiveMenu"],"mappings":"AAAAA,EAAEC,UAAUC,MAAM,WACd,GACIC,GACAC,EACAC,EAHAC,EAAMN,EAAE,QAIRO,GAAa,CACjBD,GAAIE,GAAG,aAAc,SAASC,GAE1BF,GAAa,IACdC,GAAG,aAAc,SAASC,GAEzBF,GAAa,GAEjB,IAAIG,MAEAC,EAAc,SAASF,GACvBC,EAAWE,MACPC,EAAGJ,EAAEK,MACLC,EAAGN,EAAEO,QAELN,EAAWO,OAAS,GACpBP,EAAWQ,QAInBlB,GAAE,SAASQ,GAAG,aAAc,SAASC,GAGjCT,EAAEC,UAAUO,GAAG,YAAaG,KAC7BH,GAAG,aAAc,SAASC,GAEzBH,EAAIa,SAAS,QACThB,IACAA,EAAUiB,YAAY,UACtBjB,EAAY,MAEZC,IACAA,EAAWe,SAAS,QACpBf,EAAa,MAEjBJ,EAAEC,UAAUoB,IAAI,YAAaV,KAC9BH,GAAG,aAAc,KAAM,SAASC,GAG/B,GAFAH,EAAIc,YAAY,SAEXjB,EAGD,MAFAA,GAAYH,EAAES,EAAEa,QAAQH,SAAS,eACjCf,EAAaJ,EAAE,IAAMG,EAAUoB,KAAK,OAAOH,YAAY,QAIvDf,IACAmB,aAAanB,EAGjB,IAAIoB,GAAef,EAAWA,EAAWO,OAAS,GAE9CS,EAAahB,EAAWA,EAAWO,OAAS,GAE5CU,EAAQC,UAAUtB,EAAKoB,EAAYD,EACvC,IAAIE,EACAtB,EAAQwB,WAAW,WAEXtB,IAIJJ,EAAUiB,YAAY,UACtBhB,EAAWe,SAAS,QAEpBhB,EAAYH,EAAES,EAAEa,QAAQH,SAAS,UACjCf,EAAaJ,EAAE,IAAMG,EAAUoB,KAAK,OAAOH,YAAY,QACvDf,EAAQ,OACT,SACA,CACH,GAAIyB,GAAgB3B,EAChB4B,EAAiB3B,CACrBD,GAAYH,EAAES,EAAEa,QAChBlB,EAAaJ,EAAE,IAAMG,EAAUoB,KAAK,OACpCO,EAAcV,YAAY,UAC1BW,EAAeZ,SAAS,QACxBhB,EAAUgB,SAAS,UACnBf,EAAWgB,YAAY","file":"main.js","sourcesContent":["$(document).ready(function() {\r\n    var sub = $('#sub');\r\n    var activeRow; // 触发鼠标移入的主菜单项\r\n    var activeMenu; // 激活显示的子菜单\r\n    var timer;\r\n    var mouseInSub = false; // 表示当前鼠标是否在子菜单里\r\n    sub.on('mouseenter', function(e) {\r\n        /* Act on the event */\r\n        mouseInSub = true;\r\n    }).on('mouseleave', function(e) {\r\n        /* Act on the event */\r\n        mouseInSub = false;\r\n    });\r\n    var mouseTrack = []; // 记录鼠标位置的数组\r\n    // 结合使用push和shift可以模拟队列，先进先出FIFO\r\n    var moveHandler = function(e) {\r\n        mouseTrack.push({\r\n            x: e.pageX,\r\n            y: e.pageY\r\n        })\r\n        if (mouseTrack.length > 3) {\r\n            mouseTrack.shift()\r\n        }\r\n    }\r\n    // 给整个菜单div绑定事件而不是一级菜单，否则鼠标离开一级菜单进入二级菜单会导致二级菜单不显示\r\n    $('#wrap').on('mouseenter', function(e) {\r\n        // 鼠标移入一级菜单时让二级菜单显示\r\n        \r\n        $(document).on('mousemove', moveHandler);\r\n    }).on('mouseleave', function(e) {\r\n        // 鼠标移出一级菜单时让二级菜单和子菜单内容不显示\r\n        sub.addClass('none');\r\n        if (activeRow) {\r\n            activeRow.removeClass('active');\r\n            activeRow = null;\r\n        }\r\n        if (activeMenu) {\r\n            activeMenu.addClass('none');\r\n            activeMenu = null;\r\n        }\r\n        $(document).off('mousemove', moveHandler);\r\n    }).on('mouseenter', 'li', function(e) {\r\n        sub.removeClass('none');\r\n        // 初始时鼠标没有移入一级菜单，activeRow未定义\r\n        if (!activeRow) {\r\n            activeRow = $(e.target).addClass('active');\r\n            activeMenu = $('#' + activeRow.data('id')).removeClass('none');\r\n            return; // 这里必须return，否则if语句里的代码执行结束后继续向后执行，activeRow变量undefined，会报错\r\n        }\r\n        // debounce去抖原理：在定时器回调函数最后timer = null，事件触发时，如果timer存在，说明后面的定时器回调函数没有执行到timer = null，即没有执行切换，就清除定时器队列，保证只执行一次切换，也就是最后一次\r\n        if (timer) {\r\n            clearTimeout(timer);\r\n        }\r\n        // 鼠标当前坐标\r\n        var currMousePos = mouseTrack[mouseTrack.length - 1];\r\n        // 鼠标之前的位置\r\n        var leftCorner = mouseTrack[mouseTrack.length - 2];\r\n        // 是否需要延迟\r\n        var delay = needDelay(sub, leftCorner, currMousePos)\r\n        if (delay) {\r\n            timer = setTimeout(function(){\r\n                // 如果鼠标在子菜单里，不进行子菜单的切换，直接return\r\n                if (mouseInSub) {\r\n                    return;\r\n                }\r\n                // 鼠标已经移入过一级菜单，从当前activeRow移到另一个li\r\n                activeRow.removeClass('active');\r\n                activeMenu.addClass('none');\r\n                // 将新移入的li赋值给activeRow\r\n                activeRow = $(e.target).addClass('active');\r\n                activeMenu = $('#' + activeRow.data('id')).removeClass('none');\r\n                timer = null;\r\n            }, 300)\r\n        } else {\r\n            var prevActiveRow = activeRow\r\n            var prevActiveMenu = activeMenu\r\n            activeRow = $(e.target)\r\n            activeMenu = $('#' + activeRow.data('id'))\r\n            prevActiveRow.removeClass('active')\r\n            prevActiveMenu.addClass('none')\r\n            activeRow.addClass('active');\r\n            activeMenu.removeClass('none');\r\n        }\r\n    });\r\n});"]}